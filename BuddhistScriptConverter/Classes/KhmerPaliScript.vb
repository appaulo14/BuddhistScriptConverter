Imports System.Text.RegularExpressions

Public Class KhmerPaliScript
    Inherits UnicodePaliScript

    Protected Overrides ReadOnly Property Halant() As String
        Get
            Return ChrWH("17D2")
        End Get
    End Property
    Public Overrides ReadOnly Property Name() As String
        Get
            Return "Khmer Mūla"
        End Get
    End Property
    Protected Overrides ReadOnly Property Anusvara() As String
        Get
            Return ChrWH("17C6")
        End Get
    End Property
    Protected Overrides Sub PopulateSymbols()
        With VowelSigns
            .Add(ChrWH("17B6")) 'ā
            .Add(ChrWH("17B7")) 'i
            .Add(ChrWH("17B8")) 'ī
            .Add(ChrWH("17BB")) 'u
            .Add(ChrWH("17BC")) 'ū
            .Add(ChrWH("17C1")) 'e
            .Add(ChrWH("17C4")) 'o
        End With
        'Populate consonants with two roman consonants
        With DiConsonants
            .Add(ChrWH("1781")) 'kha
            .Add(ChrWH("1783")) 'gha
            .Add(ChrWH("1786")) 'cha
            .Add(ChrWH("1788")) 'jha
            .Add(ChrWH("178B")) 'ṭha
            .Add(ChrWH("178D")) 'ḍha
            .Add(ChrWH("1790")) 'tha
            .Add(ChrWH("1792")) 'dha
            .Add(ChrWH("1795")) 'pha
            .Add(ChrWH("1797")) 'bha
        End With
        'Populate consonants with one roman consonant
        With MonoConsonants
            .Add(ChrWH("1780")) 'ka
            .Add(ChrWH("1782")) 'ga
            .Add(ChrWH("1784")) 'ṅa
            .Add(ChrWH("1785")) 'ca
            .Add(ChrWH("1787")) 'ja
            .Add(ChrWH("1789")) 'ña
            .Add(ChrWH("178A")) 'ṭa
            .Add(ChrWH("178C")) 'ḍa
            .Add(ChrWH("178E")) 'ṇa
            .Add(ChrWH("178F")) 'ta
            .Add(ChrWH("1791")) 'da
            .Add(ChrWH("1793")) 'na
            .Add(ChrWH("1794")) 'pa
            .Add(ChrWH("1796")) 'ba
            .Add(ChrWH("1798")) 'ma
            .Add(ChrWH("1799")) 'ya
            .Add(ChrWH("179A")) 'ra
            .Add(ChrWH("179B")) 'la
            .Add(ChrWH("179C")) 'va
            .Add(ChrWH("179F")) 'sa
            .Add(ChrWH("17A0")) 'ha
            .Add(ChrWH("17A1")) 'ḷa
        End With
        With Vowels
            'This goes before a so it will get converted first
            .Add(ChrWH("17A2") & ChrWH("17B6")) 'ā 
            .Add(ChrWH("17A2")) 'a
            .Add(ChrWH("17A5")) 'i
            .Add(ChrWH("17A6")) 'ī
            .Add(ChrWH("17A7")) 'u
            .Add(ChrWH("17A9")) 'ū
            .Add(ChrWH("17AF")) 'e
            .Add(ChrWH("17B1")) 'o
            '.Add(ChrWH("17B0"))'ai
            '.Add(ChrWH("17B3"))'au
        End With
        With Irregulars
            .Add(Me.Anusvara)
        End With
        With Digits
            .Add(ChrWH("17E0")) '0
            .Add(ChrWH("17E1")) '1
            .Add(ChrWH("17E2")) '2
            .Add(ChrWH("17E3")) '3 
            .Add(ChrWH("17E4")) '4
            .Add(ChrWH("17E5")) '5
            .Add(ChrWH("17E6")) '6
            .Add(ChrWH("17E7")) '7
            .Add(ChrWH("17E8")) '8
            .Add(ChrWH("17E9")) '9
        End With
        PopulateAutogeneratedLists()
        BuildSymbolsList()
    End Sub

    Public Overrides ReadOnly Property MySymbolOrder() As PaliScript.SymbolOrder
        Get
            Return SymbolOrder.IndicSource
        End Get
    End Property

    Public Overrides Function IsUsedIn(ByVal inString As String) As Boolean
        Return Regex.IsMatch(inString, "\p{IsKhmer}")
    End Function
End Class
